import spatialIUU.distanceMatrix as dm
import pandas as pd
import pytest

def test_distanceMatrix():
    data = pd.DataFrame({'timestamp': pd.to_datetime(['2016-01-01 12:00:00', '2016-01-01 12:00:00', 
                                   '2016-01-01 12:00:00', '2016-01-01 12:00:00',
                                   '2016-01-01 12:00:00', '2016-01-01 12:00:00',
                                   '2016-01-01 12:00:00', '2016-01-01 12:00:00',
                                   '2016-01-01 12:00:00', '2016-01-01 12:00:00',
                                   '2016-01-01 12:00:00', '2016-01-01 12:00:00',
                                   '2016-01-02 12:00:00', '2016-01-02 12:00:00', 
                                   '2016-01-02 12:00:00', '2016-01-02 12:00:00',
                                   '2016-01-02 12:00:00', '2016-01-02 12:00:00',
                                   '2016-01-02 12:00:00', '2016-01-02 12:00:00',
                                   '2016-01-02 12:00:00', '2016-01-02 12:00:00',
                                   '2016-01-02 12:00:00', '2016-01-02 12:00:00']),
                     'vessel_A': [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2,
                                  1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
                     'NN': [0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5,
                            0, 1, 2, 3, 4, 5, 0, 1, 2, 3, 4, 5],
                     'distance': [0, 1, 2, 3, 4, 5, 0, 2, 3, 4, 5, 6,
                                  10, 11, 12, 13, 14, 15, 10, 12, 13, 14, 15, 16]})
    jsd1 = round(dm.d_matrix(data, 'dayhour', 1)[1][0], 4)
    jsd2 = round(dm.d_matrix(data, 'dayhour', 2)[1][0], 4)
    assert ((jsd1 == 0.0778) & (jsd2 == 0.0539))


